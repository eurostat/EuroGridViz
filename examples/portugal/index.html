<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Portuguese Census Grid</title>
    <link rel="shortcut icon" href="../../assets/images/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
</head>

<body style="margin:0;">
    <div id="viz-container"></div>
</body>
<script src="../../build/gridviz.js"></script>
<script>
    let legendWidth;
    let legendHeight;
    //mobile
    if (window.screen.width < 600) {
        legendWidth = window.screen.width - 30; //margin
        legendHeight = 50;
    }

    let containerDiv = document.getElementById("viz-container");
    let viewer = new gridviz.App()
        .container(containerDiv)
        .title("Portugal 1kmÂ² census grid 2011")
        .zoom(2000) //initial camera Z value
        .nuts(true) //loads nuts topojson boundaries
        .nutsSimplification("03M") //loads nuts topojson boundaries
        .nutsCountry("PT") //filter nuts
        .showPlacenames(true)
        .placenameThresholds({ //"scale": population
            "1000": 150000,
            "800": 100000,
            // "500": 50000,
            "200": 100000,
            "100": 50000,
            "10": 12000
        })
        .placenamesCountry("PT") //filter placenames
        .zerosRemoved(3)
        .sourcesHTML("Source: <a href='https://www.efgs.info/data/national/' target='_blank'>Statistics Portugal</a>")
        .geoCenter([2677, 1964])
        //.backgroundColor("#fcf6c2")
        .backgroundColor("white")
        .build()

    const s = new gridviz.ColorSizeShapeStyle({ "colorFunction": c => gridviz.color().interpolateCividis(Math.pow(c["TOT_P"], 0.6) / 100) })
    viewer.addCSVGrid({
        url: "../../assets/csv/Portugal/PT_1km_pop_2011.csv",
        resolution: 1,
        styles: [s],
        minZoom: 0,
        maxZoom: 999999999
    });
</script>

</html>