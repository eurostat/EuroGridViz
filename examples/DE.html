<!DOCTYPE html>
<html lang="en" style="height: 100%">

<head>
    <meta name="viewport" content="maximum-scale=1.0, user-scalable=no" />
    <title>Gridviz - example</title>
</head>

<body style="margin: 0; height: 100%; font-family: Arial, Helvetica, sans-serif; overflow: hidden">
    <div id="viz-container" style="height: 100%; width: 100%"></div>

    <script src="../dist/gridviz.js"></script>
    <script>
        let containerDiv = document.getElementById('viz-container')

        new gviz.App(containerDiv)
            .setGeoCenter({ x: 4301000, y: 2889000 })
            .setZoomFactor(3)
            .addMultiScaleTiledGridLayer(
                //the resolution values, ordered
                [100, 200, 500, 1000, 2000, 5000, 10000],
                //the URL, from the resolution
                (r) =>
                    'https://raw.githubusercontent.com/jgaffuri/tiledgrids/main/data/germany/heizung/' +
                    r +
                    'm/',
                //the styles
                [
                    new gviz.CompositionStyle({
                        //x,y,Insg,fernw,etagen,zentral
                        color: {
                            fernw: '#7570b3', //purple
                            zentral: '#1b9e77', //green
                            etagen: '#d95f02', //orange
                            Insg: "gray"
                        },
                        type: () => 'piechart',
                        offsetAngle: () => 0,
                    }),
                ],
                {
                    pixNb: 12,
                    preprocess: (c) => {
                        c.fernw = +c.fernw
                        c.zentral = +c.zentral
                        c.etagen = +c.etagen
                        const a = c.Insg - c.fernw - c.etagen - c.zentral;
                        c.sonst = a < 0 ? 0 : a;
                        delete Insg
                    }
                }
            )

    </script>
</body>

</html>