<!DOCTYPE html>
<html lang="en" style="height:100%;">

<head>
    <title></title>
</head>

<body style="font-family: sans-serif;">
    <h1>Map 9.2 - Road transport performance</h1>

    <p>See <a
            href="https://ec.europa.eu/regional_policy/en/information/publications/working-papers/2019/road-transport-performance-in-europe">Road
            transport performance in Europe working paper</a>, European Commission - DG Regional and Urban Policy, 2020.
    </p>

    <div id="vizRTP" style="position:relative; height:600px; width:900px;">
        <div
            style="position: absolute; right: 0px; bottom: 0px; width: auto; height: auto; padding: 1px; border: 0px; background: #FFFFFFCC;">
            <span style="font-size: 0.8em; font-family: sans-serif;"><a href="https://github.com/eurostat/gridviz"
                    style="text-decoration:none">GridViz</a> |
                © <a href="https://eurogeographics.org" style="text-decoration:none">EuroGeographics</a></span>
        </div>
    </div>
    <div id="legendRTP"></div>
    <div>
        Administrative boundaries: ©EuroGeographics ©UN-FAO ©Turkstat
        <br>
        The designations employed and the presentation of material on this map do not imply the expression of any
        opinion whatsoever on the part of the European Union concerning the legal status of any country, territory, city
        or area or of its authorities, or concerning the delimitation of its frontiers or boundaries.
    </div>

    <script src="../../build/gridviz.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3-color@3"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3-interpolate@3"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3-scale-chromatic@3"></script>
    <script>

        let containerDiv = document.getElementById("vizRTP");
        const app = new gviz.App(containerDiv, { legendDivId: "legendRTP" })
            .setGeoCenter({ x: 4313947, y: 2970049 }).setZoomFactor(2500).setZoomFactorExtent([60, 7500])
            .setLabelLayer(gviz.getEuronymeLabelLayer()).setBoundaryLayer(gviz.getEurostatBoundariesLayer())

            .addMultiScaleTiledCSVGridLayer(
                [1000, 2000, 5000, 10000, 20000, 50000, 100000],
                r => "https://raw.githubusercontent.com/eurostat/gridviz/master/assets/csv/Europe/road_transp_perf/tiled/" + r + "m/",
                [
                    new gviz.SquareColorWGLStyle({
                        colorCol: "rp", // pp ra rp
                        color: d3.interpolateGnBu,
                        tFun: (v, r, s) => Math.min(v, 100) / 100,
                        stretching: { fun: "expRev", alpha: 2 },
                    }),
                    new gviz.StrokeStyle({ strokeColorCol: "rp", strokeColor: v => +v ? "#666" : "", maxZoom: 100 })
                ],
                {
                    pixNb: 1,
                    cellInfoHTML: c => "<b>" + c.rp + "</b> road transport performance",
                    preprocess: (c) => c.rp != ""
                })

            .addBackgroundLayer({
                url: "https://gisco-services.ec.europa.eu/maps/tiles/GreyEarth/EPSG3035/",
                resolutions: [156543.03392804097, 78271.51696402048, 39135.75848201024, 19567.87924100512, 9783.93962050256, 4891.96981025128, 2445.98490512564],
                origin: [0, 6000000],
                filterColor: zf => "#ffffffd3",
            })

        //add legend
        app.layers[0].styles[0].legends.push(new gviz.ColorLegend({
            title: "Road transport performance",
            width: 300,
            ticks: 9,
            colorRamp: d3.interpolateGnBu,
            fun: (t, r, s) => 100 * gviz.sExpRevInverse(t, 2),
        }))

    </script>

</body>

</html>