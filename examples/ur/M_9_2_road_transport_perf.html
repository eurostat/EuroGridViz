<!DOCTYPE html>
<html lang="en" style="height:100%;">

<head>
    <title></title>
</head>

<body style="font-family: sans-serif;">
    <h1>Road transport performance</h1>

    <div id="vizRTP" style="position:relative; height:600px; width:900px;">
        <div
            style="position: absolute; right: 0px; bottom: 0px; width: auto; height: auto; padding: 1px; border: 0px; background: #FFFFFFCC;">
            <span style="font-size: 0.8em; font-family: sans-serif;"><a target="_blank" rel="nofollow noreferrer noopener" href="https://github.com/eurostat/gridviz"
                    style="text-decoration:none">GridViz</a> |
                © <a target="_blank" rel="nofollow noreferrer noopener" href="https://eurogeographics.org" style="text-decoration:none">EuroGeographics</a></span>
        </div>
    </div>
    <div id="legendRTP"></div>
    <div>
        Administrative boundaries: ©EuroGeographics ©UN-FAO ©Turkstat
        <br>
        The designations employed and the presentation of material on this map do not imply the expression of any
        opinion whatsoever on the part of the European Union concerning the legal status of any country, territory, city
        or area or of its authorities, or concerning the delimitation of its frontiers or boundaries.
    </div>

    <script src="https://ec.europa.eu/assets/estat/E/E4/gisco/ure2023/gridviz.min.js"></script>
    <script src="https://ec.europa.eu/assets/estat/E/E4/gisco/ure2023/d3-color.js"></script>
    <script src="https://ec.europa.eu/assets/estat/E/E4/gisco/ure2023/d3-interpolate.js"></script>
    <script src="https://ec.europa.eu/assets/estat/E/E4/gisco/ure2023/d3-scale-chromatic.js"></script>
    <script>

        let containerDiv = document.getElementById("vizRTP");
        const app = new gviz.App(containerDiv, { legendDivId: "legendRTP" })
            .setGeoCenter({ x: 4313947, y: 2970049 }).setZoomFactor(2500).setZoomFactorExtent([60, 7500])
            .setLabelLayer(
                gviz.getEuronymeLabelLayer("EUR", 50, {
                    ccIn: ["AT", "BE", "BG", "CY", "CZ", "DE", "DK", "EE", "ES", "FI", "FR", "GR", "HR", "HU", "IE", "IT", "LT", "LU", "LV", "PL", "PT", "MT", "NL", "RO", "SE", "SK", "SI", "CH", "IS", "NO", "LI", "RS", "XK", "AL", "TR", "ME", "MK"]
                })
            ).setBoundaryLayer(gviz.getEurostatBoundariesLayer())

            .addMultiScaleTiledCSVGridLayer(
                [1000, 2000, 5000, 10000, 20000, 50000, 100000],
                r => "https://raw.githubusercontent.com/eurostat/gridviz/master/assets/csv/Europe/road_transp_perf/tiled/" + r + "m/",
                [
                    new gviz.SquareColorWGLStyle({
                        colorCol: "rp", // pp ra rp
                        color: d3.interpolateGnBu,
                        tFun: (v, r, s) => Math.min(v, 100) / 100,
                        stretching: { fun: "expRev", alpha: 2 },
                    }),
                    new gviz.StrokeStyle({ strokeColorCol: "rp", strokeColor: v => +v ? "#666" : "", maxZoom: 100 })
                ],
                {
                    pixNb: 1,
                    cellInfoHTML: c => "<b>" + c.rp + "</b> road transport performance",
                    preprocess: (c) => c.rp != ""
                })

            .addBackgroundLayer({
                url: "https://raw.githubusercontent.com/jgaffuri/mbxyz/main/pub/elevation_shading/",
                resolutions: Array.from({ length: 9 }, (_, i) => 28.00132289714475 * Math.pow(2, 10 - i)),
                origin: [0, 6000000],
                filterColor: zf => "#ffffffc0",
            })

        //add legend
        app.layers[0].styles[0].legends.push(new gviz.ColorLegend({
            title: "Road transport performance",
            width: 300,
            ticks: 9,
            colorRamp: d3.interpolateGnBu,
            fun: (t, r, s) => 100 * gviz.sExpRevInverse(t, 2),
        }))

    </script>

</body>

</html>