<!DOCTYPE html>
<html lang="en" style="height: 100%">

<head>
    <meta name="viewport" content="maximum-scale=1.0, user-scalable=no" />
    <title>Gridviz - example</title>
</head>

<body style="margin: 0; height: 100%; font-family: Arial, Helvetica, sans-serif; overflow: hidden">
    <div id="viz-container" style="height: 100%; width: 100%"></div>

    <script src="../dist/gridviz.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3-array@3"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3-geo@3"></script>
    <script>


        //UTM zone 33 with datum WGS 84
        //https://spatialreference.org/ref/epsg/32633/html/
        const proj = d3.geoTransverseMercator()
            .rotate([-15, 0])
            //.reflectX(false)
            .reflectY(true)
            .scale(6378137)//0.9996
            .translate([2501000, -27000])

        //console.log(proj([59.911, 10.7441]))
        //console.log(proj([10.7441, 59.911]))
        //console.log("2260466, 6648862")

        //define app
        let containerDiv = document.getElementById('viz-container')
        const app = new gviz.App(containerDiv)
            .setGeoCenter({ x: 2179500, y: 6783250 })
            .setZoomFactor(500)
            .setLabelLayer(gviz.getEuronymeLabelLayer('NO', '20', {
                proj: proj
            }))
        //.setBoundaryLayer(gviz.getEurostatBoundariesLayer())

        //add layer
        const ts = []; for (let i = 2002; i <= 2022; i++) ts.push("y" + i)
        app.addMultiScaleTiledGridLayer(
            [250, 500, 1000, 2000, 5000, 10000, 20000, 50000, 100000],
            (r) => 'https://raw.githubusercontent.com/jgaffuri/tiled-grid-norway/main/out/popcsv/' + r + 'm/',
            [
                new gviz.TimeSeriesStyle({
                    ts: ts,
                    color: () => "black",
                    lineWidthCol: "y2018",
                    lineWidth: (v, r, s, z) => { return (1 + gviz.sPow(v / s.max, 0.4) * 4) * z },
                    //offsetX: (c, r, z) => r / 2,
                    //offsetY: (c, r, z) => r / 2,
                    //width: (c, r, z) => 1.5*r,
                    //height: (c, r, z) => 2*r,
                    //anchorModeY: (c, r, z) => "first"
                })],
            {
                pixNb: 10,
            }
        )

    </script>
</body>

</html>